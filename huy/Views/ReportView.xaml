<UserControl x:Class="huy.Views.ReportView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:viewmodels="clr-namespace:huy.ViewModels">
    
    <UserControl.DataContext>
        <viewmodels:ReportViewModel />
    </UserControl.DataContext>
    
    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        
        <!-- Report Title -->
        <TextBlock Grid.Row="0" Text="FU Mini Hotel - Reports" FontSize="24" FontWeight="Bold" Margin="0,0,0,20"/>
        
        <!-- Report Controls -->
        <Grid Grid.Row="1" Margin="0,0,0,20">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="Auto"/>
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>
            
            <StackPanel Grid.Column="0" Orientation="Horizontal">
                <TextBlock Text="Start Date:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <DatePicker SelectedDate="{Binding StartDate}" Width="150" Margin="0,0,20,0"/>
                
                <TextBlock Text="End Date:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                <DatePicker SelectedDate="{Binding EndDate}" Width="150" Margin="0,0,20,0"/>
                
                <Button Content="Generate Report" Command="{Binding GenerateReportCommand}" Width="120"/>
            </StackPanel>
        </Grid>
        
        <!-- Report Summary -->
        <Border Grid.Row="2" BorderBrush="Gray" BorderThickness="1" Padding="15" Margin="0,0,0,20" Background="#f8f9fa">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="*"/>
                </Grid.ColumnDefinitions>
                
                <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                    <TextBlock Text="Total Bookings" FontWeight="Bold" FontSize="16"/>
                    <TextBlock Text="{Binding TotalBookings}" FontSize="24" HorizontalAlignment="Center"/>
                </StackPanel>
                
                <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                    <TextBlock Text="Total Revenue" FontWeight="Bold" FontSize="16"/>
                    <TextBlock Text="{Binding TotalRevenue, StringFormat=\{0:C\}}" FontSize="24" HorizontalAlignment="Center"/>
                </StackPanel>
                
                <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                    <TextBlock Text="Unique Customers" FontWeight="Bold" FontSize="16"/>
                    <TextBlock Text="{Binding TotalCustomers}" FontSize="24" HorizontalAlignment="Center"/>
                </StackPanel>
            </Grid>
        </Border>
        
        <!-- Report Content -->
        <Grid Grid.Row="3">
            <Grid.Style>
                <Style TargetType="Grid">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding ReportType}" Value="Bookings">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding ReportType}" Value="Revenue">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                        <DataTrigger Binding="{Binding ReportType}" Value="Customers">
                            <Setter Property="Visibility" Value="Visible"/>
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </Grid.Style>
            
            <DataGrid ItemsSource="{Binding Bookings}" AutoGenerateColumns="False" IsReadOnly="True" 
                      BorderThickness="1" BorderBrush="Gray">
                <DataGrid.Style>
                    <Style TargetType="DataGrid">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ReportType}" Value="Bookings">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding ReportType}" Value="Revenue">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding ReportType}" Value="Customers">
                                <Setter Property="Visibility" Value="Collapsed"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </DataGrid.Style>
                <DataGrid.Columns>
                    <DataGridTextColumn Header="Booking ID" Binding="{Binding BookingReservationID}" Width="80"/>
                    <DataGridTextColumn Header="Customer" Binding="{Binding Customer.CustomerName}" Width="150"/>
                    <DataGridTextColumn Header="Room Number" Binding="{Binding Room.RoomNumber}" Width="100"/>
                    <DataGridTextColumn Header="Booking Date" Binding="{Binding BookingDate, StringFormat=\{0:dd/MM/yyyy\}}" Width="100"/>
                    <DataGridTextColumn Header="Check-in" Binding="{Binding StartDate, StringFormat=\{0:dd/MM/yyyy\}}" Width="100"/>
                    <DataGridTextColumn Header="Check-out" Binding="{Binding EndDate, StringFormat=\{0:dd/MM/yyyy\}}" Width="100"/>
                    <DataGridTextColumn Header="Total Price" Binding="{Binding TotalPrice, StringFormat=\{0:C\}}" Width="100"/>
                    <DataGridTextColumn Header="Status" Binding="{Binding BookingStatus}" Width="80"/>
                </DataGrid.Columns>
            </DataGrid>
            
            <!-- Revenue Report -->
            <Grid Visibility="Collapsed">
                <Grid.Style>
                    <Style TargetType="Grid">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ReportType}" Value="Revenue">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>
                
                <DataGrid ItemsSource="{Binding Bookings}" AutoGenerateColumns="False" IsReadOnly="True" 
                          BorderThickness="1" BorderBrush="Gray">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Room Number" Binding="{Binding Room.RoomNumber}" Width="100"/>
                        <DataGridTextColumn Header="Room Type" Binding="{Binding Room.RoomType.RoomTypeName}" Width="150"/>
                        <DataGridTextColumn Header="Booking Date" Binding="{Binding BookingDate, StringFormat=\{0:dd/MM/yyyy\}}" Width="100"/>
                        <DataGridTextColumn Header="Duration (Days)" Binding="{Binding BookingDuration}" Width="120"/>
                        <DataGridTextColumn Header="Price Per Day" Binding="{Binding Room.RoomPricePerDate, StringFormat=\{0:C\}}" Width="120"/>
                        <DataGridTextColumn Header="Total Price" Binding="{Binding TotalPrice, StringFormat=\{0:C\}}" Width="120"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
            
            <!-- Customer Report -->
            <Grid Visibility="Collapsed">
                <Grid.Style>
                    <Style TargetType="Grid">
                        <Style.Triggers>
                            <DataTrigger Binding="{Binding ReportType}" Value="Customers">
                                <Setter Property="Visibility" Value="Visible"/>
                            </DataTrigger>
                        </Style.Triggers>
                    </Style>
                </Grid.Style>
                
                <DataGrid ItemsSource="{Binding Bookings}" AutoGenerateColumns="False" IsReadOnly="True" 
                          BorderThickness="1" BorderBrush="Gray">
                    <DataGrid.Columns>
                        <DataGridTextColumn Header="Customer ID" Binding="{Binding Customer.CustomerID}" Width="80"/>
                        <DataGridTextColumn Header="Customer Name" Binding="{Binding Customer.CustomerName}" Width="150"/>
                        <DataGridTextColumn Header="Email" Binding="{Binding Customer.CustomerEmail}" Width="180"/>
                        <DataGridTextColumn Header="Phone" Binding="{Binding Customer.Telephone}" Width="120"/>
                        <DataGridTextColumn Header="Booking Date" Binding="{Binding BookingDate, StringFormat=\{0:dd/MM/yyyy\}}" Width="100"/>
                        <DataGridTextColumn Header="Total Price" Binding="{Binding TotalPrice, StringFormat=\{0:C\}}" Width="120"/>
                    </DataGrid.Columns>
                </DataGrid>
            </Grid>
            
            <TextBlock Text="{Binding ErrorMessage}" Foreground="Red" VerticalAlignment="Center" HorizontalAlignment="Center"
                       FontSize="16" Visibility="{Binding ErrorMessage, Converter={StaticResource StringVisibilityConverter}}"/>
        </Grid>
    </Grid>
</UserControl> 